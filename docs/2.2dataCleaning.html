<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Inspect output</title>

<script src="site_libs/header-attrs-2.11.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="assets/mystyle.css" type="text/css" />
<link rel="stylesheet" href="assets/murdoch-fonts.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Systems Medicine</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book-open"></span>
     
    BIO 513
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01seqProcessing.html">Sequence processing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book-open"></span>
     
    BIO 514
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="2.introBIO514.html">Introduction</a>
    </li>
    <li>
      <a href="2.setup.html">Set up</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="2.1seqProcessing.html">Sequence processing</a>
    </li>
    <li>
      <a href="2.2dataCleaning.html">Data Cleaning</a>
    </li>
    <li>
      <a href="2.3dataViz.html">Data visualization</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/siobhon-egan/2022-systMed-genomics">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Inspect output</h1>

</div>


<p>While we will not perform these steps today but we’ll spend a few minutes just talking about some data processing steps after sequence clustering/denoising.</p>
<p>Depending on your aims the importance of these steps will differ.</p>
<div id="check-taxonomy" class="section level2">
<h2>Check taxonomy</h2>
<p>Again this will depend on what the aims of your study are. For most ‘composition’ studies or those relying on broad scale trends in patterns this won’t be as important. However, if you are using microbiome/metagenomics for diagnostic purposes or pathogen studies you will need to confirm taxa. The best method/databases will depend on your taxa. For some groups of bacteria differentiation using partial sequence of 16S gene is not possible (e.g. <em>Rickettsia</em>). Also the quality of reference databases will also depend on the region you sequence. Generally sequencing the start (e.g. V1-2) has less references available then the middle of the 16S gene (e.g. V3-4).</p>
<p>Remember from <a href="02_bioinformatics.html">bioinformatics overview</a> we spoke about two aspects to this (1) Assignment algorithms and (2) Reference databases.</p>
<p>Generally pipelines use curated bacteria 16S databases but if your sequence does not match any bacteria it will classify as unknown. Most people use NCBI BLAST against all sequence data to confirm identity for any taxa that require further confirmation.</p>
<p>The more accurate your taxonomic assignment the better downstream analysis is - in particular <strong>functional assignment</strong> and <strong>16S gene copy number prediction</strong> (see below).</p>
</div>
<div id="clean-sequence-data" class="section level2">
<h2>Clean sequence data</h2>
<p>Remember your control from the extraction process? Well this is where you subtract that “background” bacteria noise.</p>
<p>Additional bonus points for</p>
<ul>
<li>Using mock communities (e.g. Mock Bacteria ARchaea Community; MBARC-26, ref: Singer et al. <em>Sci Data</em> 3, 160081 (2016). doi: <a href="https://doi.org/10.1038/sdata.2016.81">10.1038/sdata.2016.81</a>)</li>
<li>Quantifying input DNA concentration which can then be used for frequency detection methods using <a href="https://benjjneb.github.io/decontam/vignettes/decontam_intro.html#identify-contaminants---frequency">decontam package</a> (details below).</li>
</ul>
<p><strong>The <code>Decontam</code> R Package</strong></p>
<p><a href="https://benjjneb.github.io/decontam/">decontam</a> with detailed <a href="https://benjjneb.github.io/decontam/vignettes/decontam_intro.html">tutorial</a></p>
<p>Reference: Davis et al. (2018) <em>Microbiome</em>, 6, 226 doi: <a href="https://doi.org/10.1186/s40168-018-0605-2">10.1186/s40168-018-0605-2</a>.</p>
<p>Simple code for identifying contaminant taxa based on prevalence data. Phyloseq object is <code>ps</code> and the sample data has a column called <code>Sample_or_Control</code> where the control samples are <code>Control Sample</code>. Default prevalence threshold is set to <code>0.1</code>. I recommend you check what taxa is identified as “contaminant” and see if it makes sense (this where its good to know something about your samples/microbiology). You may need to adjust threshold as needed, e.g. for more aggressive classification threshold rather than the default try <code>0.5</code>.</p>
<p>Install package</p>
<pre><code># Install package
if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))
    install.packages(&quot;BiocManager&quot;)
BiocManager::install(&quot;decontam&quot;)</code></pre>
<p>Define control samples and identify taxa present in them using prevalence method.</p>
<pre><code>sample_data(ps)$is.neg &lt;- sample_data(ps)$Sample_or_Control == &quot;Control Sample&quot;
contamdf.prev &lt;- isContaminant(ps, method=&quot;prevalence&quot;, neg=&quot;is.neg&quot;)
# Identify how many contaminants
head(which(contamdf.prev$contaminant))
# Identify what the contaminants are
table(contamdf.prev$contaminant)</code></pre>
<p>Set contaminant threshold (default is 0.1).</p>
<pre><code>contamdf.prev01 &lt;- isContaminant(ps, method=&quot;prevalence&quot;, neg=&quot;is.neg&quot;, threshold=0.1)
table(contamdf.prev01$contaminant)</code></pre>
<p>Then you “subtract” these taxa from your data set. Raw data is phyloseq object <code>ps</code> and will create new phyloseq object for downstream analysis <code>ps.decon</code></p>
<pre><code>ps.decon &lt;- prune_taxa(!contamdf.freq$contaminant, ps)
ps.decon</code></pre>
<p><strong>Alternative:</strong> a very similar R package called <code>microDecon</code> also available <a href="https://github.com/donaldtmcknight/microDecon">GitHub repo</a>.<br />
Reference: McKnight et al. (2019) <em>Environmental DNA</em>, 1, 14-25 doi: <a href="https://doi.org/10.1002/edn3.11">10.1002/edn3.11</a>.</p>
</div>
<div id="functional-assignment" class="section level2">
<h2>Functional assignment</h2>
<p>Bacterial profiling based on 16S rRNA-based surveys gives a “who’s there?” answer. However as our knowledge improves more questions arise and now we are moving to answer question about “what can they do?”.</p>
<p>Just like with taxonomy databases there are functional databases that group taxa into functional groups. The polypeptides predicted from these sequences are annotated by homology to gene function databases.</p>
<p>Some reading:</p>
<ul>
<li>Dantas G, Sommer MO, Degnan PH, Goodman AL. Experimental approaches for defining functional roles of microbes in the human gut. Annu Rev Microbiol. 2013;67:459-475. doi: <a href="https://doi.org/10.1146/annurev-micro-092412-155642">10.1146/annurev-micro-092412-155642</a></li>
<li>Qin J, Li R, Raes J, et al. A human gut microbial gene catalogue established by metagenomic sequencing. Nature. 2010;464(7285):59-65. doi: <a href="https://doi.org/10.1038/nature08821">10.1038/nature08821</a></li>
</ul>
<p><strong>A word of caution</strong><br />
“…inference with the default database is likely limited outside of human samples and that development of tools for gene prediction specific to different non-human and environmental samples is warranted.” - Quote from Sun et al. (2020) <em>Microbiome</em> 8, 45 doi: <a href="https://doi.org/10.1186/s40168-020-00815-y">10.1186/s40168-020-00815-y</a></p>
<p>Popular databases:</p>
<ul>
<li>PICRUSt - Langille et al. (2013) <em>Nat Biotechnol</em> 31(9), 814-821 doi: <a href="https://doi.org/10.1038/nbt.2676">10.1038/nbt.2676</a></li>
<li>CopyRighter - Angly et al. (2014) <em>Microbiome</em> 2, 11 doi: <a href="https://doi.org/10.1186/2049-2618-2-11">10.1186/2049-2618-2-11</a></li>
<li>PAPRICA - Dowman and Ducklow (2015) 10(8), e0135868 <em>PLoS ONE</em> doi: <a href="https://doi.org/10.1371/journal.pone.0135868">10.1371/journal.pone.0135868</a></li>
<li>Tax4Fun - ABhauer et al (2015) <em>Bioinformatics.</em> 31, 2882–4, doi: <a href="https://doi.org/10.1093/bioinformatics/btv287">10.1093/bioinformatics/btv287</a></li>
</ul>
</div>
<div id="correct-for-16s-sequence-abundance" class="section level2">
<h2>Correct for 16S sequence abundance</h2>
<p>Number of copies of the 16S rRNA gene in bacteria varies (1-15). Still not widely used and so far databases/tools are not worthwhile.</p>
<p>Summary of findings in Louca et al. (2018). <em>Microbiome</em> 6, 41 doi: <a href="https://doi.org/10.1186/s40168-018-0420-9">10.1186/s40168-018-0420-9</a>.</p>
<ul>
<li>“…16S gene copy numbers (GCNs) could only be accurately predicted for a limited fraction of taxa, namely taxa with closely to moderately related representatives (&lt;15% divergence in the 16S rRNA gene).”</li>
<li>“…all considered tools exhibit low predictive accuracy when evaluated against completely sequenced genomes, in some cases explaining less than 10% of the variance.”</li>
<li>“Substantial disagreement was also observed between tools (R2&lt;0.5) for the majority of tested microbial communities”</li>
<li><em>In summary</em>: “We recommend <strong>against correcting for 16S GCNs</strong> in microbiome surveys by default…”</li>
</ul>
<p>Some other references:</p>
<ul>
<li>PICRUSt - Langille et al. (2013) <em>Nat Biotechnol</em> 31(9), 814-821 doi: <a href="https://doi.org/10.1038/nbt.2676">10.1038/nbt.2676</a></li>
<li>CopyRighter - Angly et al. (2014) <em>Microbiome</em> 2, 11 doi: <a href="https://doi.org/10.1186/2049-2618-2-11">10.1186/2049-2618-2-11</a></li>
<li>PAPRICA - Dowman and Ducklow (2015) 10(8), e0135868 <em>PLoS ONE</em> doi: <a href="https://doi.org/10.1371/journal.pone.0135868">10.1371/journal.pone.0135868</a></li>
<li>UNBIAS <a href="https://www.biorxiv.org/content/10.1101/124149v1.full.pdf">Edgar preprint</a> available in <a href="https://www.drive5.com/usearch/">USEARCH</a></li>
</ul>
</div>

<hr> 
<div class="logos"><img src="assets/squaremu.png" width="50px" align="right"></div>

<br></br>

<p style="text-align: center;"><span style="color: #4F5556;"><em>Copyright, Siobhon Egan, 2022.</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/siobhon-egan/BIO510-microbiome" class="fa fa-github"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
